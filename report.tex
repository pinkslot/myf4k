\documentclass[12pt,a4paper]{article}
\usepackage{russ}
\usepackage[left=1cm,right=1cm,top=2cm,bottom=2cm]{geometry}
\usepackage{dsfont}

\title{4-7}
\author{Anton Kim}
\date{March 2014}

\begin{document}
\section{Обнаружение рыб}
    В проекте fish4knowledge процесс распознавания рыб на видео производиться в два этапа. Целью первого этапа является выделение контуров объектов переднего плана. На втором этапе производиться анализ изображений найденных объектов с целью их классификации.
 \subsection{Выделение объектов переднего плана}
    Одним из наиболее эффективных подходов обнаружения объектов на видео является построение модели фона. Данный подход обладает рядом преимуществ в сравнении с методами основанными на анализе градиентных преобразований(детектор Канни), существенных для анализа наших данных. Во первую очередь к ним можно отнести не столь сильную зависимость от контрастности изображения объектов, характерных для наблюдения естественных сцен. Во вторых моделирование фона не испытывает затруднений при работе с неоднородным фоном, кроме того имеются методы позволяющие моделировать достаточно контрастные, периодические изменения в фоне.
    Итак рассмотрим сначала саму идеологию методов данной группы. Базовую идею представляет метод вычитания фона. Если имеется эталонное изображение фона, то для определение движущихся объектов достаточно сравнивать значения каждого пиксела с эталонным изображением. Тогда пиксела, значения в которых будет сильно отличаться от эталонных, можно признать пикселами объектов переднего плана. Рассмотрим недостатки данного метода при анализе естественных сцен.
    \begin{itemize}
    \item{Наличие эталонного изображения.} Нахождение значений пикселов которые следует отнести к фоновым, по имеющимся кадрам видео, является основной проблемой построения модели фона. Методы рассмотренные в этой главе как раз направлены на её решение с учётом специфики нашей задачи.
    \item{Изменение освещения.} Постепенное, равномерное изменение яркости пикселов может сильно отклонить изображение фона сцены от эталонного. Для борьбы с этой проблемой используются методы адаптирующиеся к мелким изменениям сцены, путём добавления в модель фона значений из последних кадров.
    \item{Небольшие изменения значений.} Данные эффекты вызваны целым рядом причин, такими как неточность измерения видеокамеры, блики, наличие естественного шума. Для подавления их влияния фон моделируется одним из статистических распределений учитывающих возможность таких выбросов.
    \item{Мультимодальные значения пикселов.} Часто в качестве фона нам хотелось бы иметь не одно изображение а сразу несколько. Например, при наблюдении двора жилого дома, машину въехавшую во двор следовало бы отнести к объектом переднего план, но если машина остановилась и в течении долгого времени находиться на одном месте, было бы уместным включить её в модель фона и обнаруживать движения уже других объектов на её фоне. Для наших данных примером таких объектов может стать достаточно контрастный буй, периодически покачивающийся под влиянием волн. Использование целой смеси распределений для моделирования фона позволяет справиться с этой задачей.
    \end{itemize}

    Проект fish4knowledge предлагает реализацию алгоритма AGMM(Adaptive Gaussian Mixture Model). Как следует из названия для моделирования каждого пиксела фона используется смесь нормальных распределений, адаптивно изменяющихся со временем. Рассмотрим теперь подробнее правило выбора конкретных параметров модели, а также процедуру проверки пиксела на принадлежность фону.\cite{agmm}

    Для начала отметим обусловленность выбора нормального распределения в качестве базовой модели, как распределения учитывающего малые отклонения от истинного значения пиксела. В каждый момент времени фон моделируется смесью нормальных распределений (многомерных в случае цветного изображения) с нормированными весами $\omega$
    \[
        \eta = \sum_{j=1..k}\omega_{i,t} \eta_j(\mu_{i, t}, \Sigma_{i,t})
    \]
    где $\mu_{i, t}$ - вектор мат. ожидания, $\Sigma_{i,t}$ - ковариационная матрица . Из вычислительных соображений, предполагается, что $\Sigma_{i,t} = \sigma^2_iI$, где $\sigma^2_i$ - вектор дисперсий(используется некорректная запись где результат $\sigma^2_iI$ - диагональная матрица с элементами вектора $\sigma^2$ на диагонали). Данное предположение эквивалентно предположению независимости цветовых компонент. Новое значение пиксела $X_t$ проверяется на соответствие каждому распределению, критерием соответствия является попадание в область $2.5 \sigma$ вокруг среднего значения. Далее возможны два варианта развития событий:
    \begin{itemize}
    \item{Соответствует некоторым распределениям} Пиксел признаётся фоновым, если среди этих распределений, хотя бы одно принадлежит множеству фоновых компонент, выбор которых оговаривается далее. Для данных распределений параметры пересчитывается по следующим формулам
    \[
        \omega_t = (1-\alpha)\omega_{t-1} + \alpha
    \]
    \[
        \mu_t = (1-p)\mu_{t-1}+\rho X_t
    \]
    \[
        \sigma^2_t = (1-p)\sigma^2{t-1}+\rho (X_t - \mu_t)^T(X_t - \mu_t)
    \]
    ,где $\rho = \alpha\eta(X_t|\mu_t,\sigma_k)$, $\eta(X_t|\mu_t,\sigma_k)$ - вероятность $X_t$ в предыдущей модели, $\alpha \in (0,1)$ - параметр обучаемости, выбор которого позволяет изменять скорость адаптации модели к изменениям. Также после пересчета весов $\omega$ требуется выполнить их нормализацию.

    \item{Не соответствует никакому распределению.} Пиксел признаётся объектом переднего плана. В смесь добавляется дополнительная компонента $\eta_k(X_t, 1), \omega_k = \alpha$.
    Далее гаусианы упорядочиваются по убыванию параметра $\frac{\omega_j}{\sigma_j}$, и выбираются $B$ первых компонент, где $B = arg(\min_{b}(\sum_{k=1..b}\omega_k > T))$, выбор параметра $T$ определяет сколько различных цветов пиксела может быть одновременно ассоциированы с фоном. Данные компоненты объявляются фоновыми. Упорядочивание признаков по такому критерию основано на естественном предположении о том что статичный фон менее подвержен колебаниям цвета(т.е. имеет меньшую дисперсию), чем движущиеся объекты.
    \end{itemize}

    Таким образом мы получили метод позволяющий разделить пикселы исходного изображения на фоновые и принадлежащие объектам переднего плана, имеющий два конфигурационных параметра $\alpha, T$ - один из которых отвечает за скорость адаптации фона к изменениям, а второй за количество различных распределений, признаваемых фоновыми для каждого пикселя в каждый момент. Для выделение самих объектов теперь остаётся выполнить поиск связанных компонент над бинарным изображением.

    Также следует отметить что кроме описанного выше в проекте также реализованы такие методы как APMM(Adaptive Poisson Mixture Model), аналогичный AGMM, но с использованием, вместо нормального распределения, распределение Пуассона. И Wave-back метод, основанный на моделирование фона при помощи не самих значений пикселов в течении времени, а частотных характеристик процесса их изменения.

 \subsection{Классификация объектов}
    Базовым методом классификации объектов в проекте fish4knoledge является SVM. Этот классификатор относятся к бинарным линейным классификаторам, целью которых является выбор гиперплоскости, которая бы разделила пространство признаков на две части, соответствующие различным классам\cite{svm}. Для случая линейной разделимости векторов обучающей выборки, SVM-метод предлагает выбирать плоскость таким образом что расстояние от неё до ближайших точек обоих классов было одинаково и максимально.
    Запишем теперь вышеназванные условия более формально. Искомое уравнение гиперплоскости представим как $(w,x) - b = 0$,
    а множество примеров обучающей выборки $(x_i, c_i)$, где $x_i$ - вектор признаков, а $c_i \in [-1,1]$ - метка класса.
    Нормализуем константы $w, b$ таким образом чтобы расстояние до ближайших точек $x_i$ равнялось $c_i$, т.е $\pm 1$. Тогда ширина разделяющейся полосы будет равна $\frac{2}{\sqrt{(w,w)}}$. И наши условия запишутся как:
    \[
        \left\{
        \begin{array}{l}
            (w,w) \rightarrow \max \\
            (w,x_i) - b \geq c_i
        \end{array}
        \right.
    \]
    Таким образом задача сведена к решению задачи квадратичного программирования. Для случая в котором линейная разделимость недопустима, вводятся дополнительные штрафы за ошибку классификации, которые принципиально не изменяют исходную задачу квадратичной оптимизации.

    Для перехода от мультиклассовой задачи к бинарной используются различные подходы. В исследуемой работе разработан оригинальный метод построения бинарного сбалансированного дерева для решения данной задачи. Исходное множество классов делиться на две равные подгруппы таким образом, чтобы SVM метод классифицировал на принадлежность к ним наиболее эффективно. Затем каждая из этих подгрупп повторно подвергается разделению на две подгруппы, по такому же принципу. Таким образом будет построено бинарное сбалансированное дерево, на каждом узле которого для входного вектора признаков будет проведена классификация SVM методом, который отнесёт его к одной из подгрупп, а после прохождения $\log_2(N)$ узлов вектор будет классифицирован как объект одного из $N$ исходных классов.
    Данный способ построение решающего дерева обоснован борьбой с проблемой накопления ошибки, которая характерна для всех иерархических методов. Суть проблемы заключается в том, что окончательная ошибка классификации является произведением ошибок каждого классификатора, через которые прошёл классифицируемый объект. Сбалансированность дерева, позволяет минимизировать количество сомножителей, а использование наиболее точных классификаторов на каждом уровне, уменьшает ошибку классификации в верхних узлах, которая войдёт во все дочерние узлы.

    Признаки использующиеся для классификации можно разделить на три группы: цветовые, контурные и текстурные.
    Для выделения цветовых признаков используются красная и зеленая компонента RGB представления изображения и тоновая компонента HSV представления. Данный приём позволяет уменьшить снизить влияние компонент характеризующих освещенность объекта. Затем исходные значения гистограмм $b_j$ уравновешиваются по следующему правилу:
    \[
        B_i = \sum_{j = a_i}^{a_{i+1}} b_j
    \]
    где $a_i = \min\{X \in \mathds{N}^+: \sum_{j = 1}^X \overline{b_j} \geq \frac{i}{11}\}$, $\overline{b_j}$ - значения усредненных гистограмм обучающей выборки.

    Для вычисления текстурных и контурных признаков изображение предварительно поворачивается таким образом, чтобы ось проходящая через голову и хвост рыбы располагалась горизонтально. Для вычисления этой оси рассчитывается кривизна кривой в каждом пикселе границы, и используется следующее наблюдение: хвостовая часть рыбы имеет более высокую кривизну чем её головная часть.

    В качестве текстурных признаков используется фильтр Габора, а также 12 признаков Харалика\cite{haral} основанные на построении матрицы совместной встречаемости яркостей(co-occurrence matrix). Данная матрица вычисляются для каждой пары цветов из RGB представления изображения.

    Контурные признаки представлены гистограммой ориентации градиентов и инвариантными моментами изображения.

\begin{thebibliography}{W:0000}
\bibitem{agmm} C Stauffer and W E L Grimson. Adaptive background mixture models for real-time tracking. Proceedings 1999 IEEE Computer Society Conference on Computer Vision and Pattern Recognition Cat No PR00149. 2(c):246-252, 1999.
\bibitem{svm}  К.В. Воронцов. Лекции по методу опорных векторов. 2007.
\bibitem{haral} Н.В. Колодникова. Обзор текстурных признаков для задач распознавания образов.Доклады ТУСУРа 2004г Автоматизированные системы обработки информации, управления и проектирования.УДК 004.93’11.
\end{thebibliography}
\end{document}

